@isTest
private class TestUpdateContactRecordTypeBatch {

    @isTest
    static void testContactBatchExecution() {
        // Step 1: Create a custom RecordType for Contact
        RecordType rt = new RecordType(
            SObjectType = 'Contact',
            DeveloperName = 'Your_RecordType_Name',
            Name = 'Test Contact RT',
            IsActive = true
        );
        insert rt;

        // Step 2: Create test Contact records with ABC_LDAP__c set
        List<Contact> contacts = new List<Contact>();
        for (Integer i = 0; i < 5; i++) {
            contacts.add(new Contact(
                LastName = 'Test Contact ' + i,
                ABC_LDAP__c = 'LDAP_' + i
            ));
        }
        insert contacts;

        // Step 3: Run the batch
        Test.startTest();
            UpdateContactRecordTypeBatch batch = new UpdateContactRecordTypeBatch();
            Database.executeBatch(batch, 2);
        Test.stopTest();

        // Step 4: Assert RecordTypeId is updated
        List<Contact> updatedContacts = [
            SELECT RecordTypeId FROM Contact WHERE ABC_LDAP__c != null
        ];
        for (Contact c : updatedContacts) {
            System.assertEquals(rt.Id, c.RecordTypeId, 'RecordTypeId should match expected');
        }

        // Step 5: Assert email was sent
        System.assertEquals(1, Limits.getEmailInvocations(), 'One email should be sent');
    }
}
